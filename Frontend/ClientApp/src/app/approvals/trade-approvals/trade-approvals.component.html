<div>
  <mat-card>
    <mat-card-content>
      <div fxLayoutAlign="space-around space-around" fxLayout="column">
        <!-- Toolbar for the table header -->
        <mat-toolbar color="accent" class="mat-elevation-z8 slim slim">
          <mat-icon class="material-icons">view_comfy</mat-icon>
          <span class="spacer">Pending Approvals</span>
          <div class="spacer"></div>
        </mat-toolbar>
        <div class="table-responsive">
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>Action</th>
                <th>TradeName</th>
                <th>TradeCode</th>
                <th>Sector</th>
                <th>SubSector</th>
              </tr>
            </thead>
            <tbody>
              <!-- Display message when no trades are available -->
              <tr *ngIf="!trades">
                <td colspan="9" class="text-center">
                  <p>No Pending Approval</p>
                </td>
              </tr>
              <!-- Iterate over trades to display each row -->
              <ng-container *ngFor="let r of trades">
                <tr>
                  <td>
                    <!-- Reduced size Decision button -->
                    <button mat-raised-button color="primary" type="button" class="decision-btn"
                      (click)="openApprovalDialogue(r)">
                      Decision
                    </button>
                    <!-- Show Details button with conditional up/down arrow -->
                    <button mat-raised-button color="accent" type="button" class="details-btn"
                      (click)="toggleDetails(r)">
                      <mat-icon>{{ r.showDetails ? 'arrow_drop_up' : 'arrow_drop_down' }}</mat-icon>
                      Details
                    </button>
                  </td>
                  <td>{{r.TradeName}}</td>
                  <td>{{r.TradeCode}}</td>
                  <td>{{r.SectorName}}</td>
                  <td>{{r.SubSectorName}}</td>
                </tr>
                <!-- Nested table for trade details, shown directly below the selected row -->
                <tr *ngIf="r.showDetails">
                  <td colspan="9">
                    <table class="table table-bordered nested-table">
                      <thead>
                        <tr>
                          <th>Duration (Hours)</th>
                          <th>Total Training Hours</th>
                          <th>Daily Training Hours</th>
                          <th>Weekly Training Hours</th>
                          <th>Certification Category</th>
                          <th>Certification Authority</th>
                          <th>Source of Curriculum</th>
                          <th>Trainee Education Type</th>
                          <th>Trainee Academic Discipline</th>
                          <th>Practical %</th>
                          <th>Theory %</th>
                          <th>Trainer Education Type</th>
                          <th>Trainer Academic Discipline</th>
                          <th>Equipment Tool</th>
                          <th>Consumable Material</th>
                          <th>Mapped With Class</th>
                        </tr>
                      </thead>
                      <tbody>
                        <!-- Show loading or no-data state -->
                        <tr *ngIf="!r.details || r.details.length === 0">
                          <td colspan="16" class="text-center">No details available</td>
                        </tr>
                        <!-- Iterate over multiple detail rows -->
                        <tr *ngFor="let detail of r.details">
                          <td>{{getDurationName(detail.DurationID)}}</td>
                          <td>{{detail.TotalTrainingHours}}</td>
                          <td>{{detail.DailyTrainingHours}}</td>
                          <td>{{detail.WeeklyTrainingHours}}</td>
                          <td>{{getCertificationCategoryName(detail.CertificationCategoryID)}}</td>
                          <td>{{getCertificationAuthorityName(detail.CertAuthID)}}</td>
                          <td>{{detail.SourceOfCurriculumName}}</td>
                          <td>{{getEducationTypeName(detail.TraineeEducationTypeID)}}</td>
                          <td>{{getAcademicDisciplineName(detail.TraineeAcademicDisciplineID)}}</td>
                          <td>{{detail.PracticalPercentage}}</td>
                          <td>{{detail.TheoryPercentage}}</td>
                          <td>{{getEducationTypeName(detail.TrainerEducationTypeID)}}</td>
                          <td>{{getAcademicDisciplineName(detail.TrainerAcademicDisciplineID)}}</td>
                          <td>{{getEquipmentToolNames(detail.EquipmentToolID)}}</td>
                          <td>{{getConsumableMaterialNames(detail.ConsumableMaterialID)}}</td>
                          <td>{{detail.MappedWithClass ? 'Yes' : 'No'}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>